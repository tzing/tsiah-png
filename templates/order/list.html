{% extends 'basic.html' %}
{% load i18n %}
{% load humanize%}

{% block content %}
<div class="ui vertical segment">
    <div class="ui breadcrumb">
        <a class="section" href="{% url 'homepage' %}">{% trans 'Tsia̍h-Pn̄g' %}</a>
        <div class="divider"> / </div>
        <div class="active section">{{ title }}</div>
    </div>
</div><!-- ./breadcrumb -->

<a class="ui green labeled icon button" href="{% url 'order_create' %}">
    <i class="plus icon"></i>
    {% trans 'New order' %}
</a>

<div class="ui items">
    {% for order in orders %}
    <div class="item">
        <div class="image">
            <div class="ui date card {% if order.is_open %}green{% else %}grey{% endif %}">
                <div class="content">
                    <h2>{{ order.order_date_short }}</h2>
                    <p>{{ order.shop }}</p>
                </div>
            </div>
        </div>
        <div class="content">
            <div class="header"><a href="{% url 'order_detail' order.id %}">{{ order }}</a></div>

            {% with order.create_time as create_time %}
            <div class="meta">{% blocktrans %}Created on {{ create_time }}{% endblocktrans %}</div>
            {% endwith %}

            {% if order.note %}
            <div class="description">
                {{ order.note }}
            </div>
            {% endif %}

            <div class="extra">
                {% with total_price=order.total_price|intcomma total_qty=order.total_quantity|intcomma %}
                {% blocktrans %}Ordered {{ total_qty }} items. ${{ total_price }} dollars in total.{% endblocktrans %}
                {% endwith %}
            </div>

        </div>
    </div>
    {% empty %}
    <div class="item">
        <div class="image">
            <div class="ui grey date card">
                <div class="content center aligned">
                    <i class="big question icon" style="color: #767676;"></i>
                </div>
            </div>
        </div>
        <div class="content">
            <div class="header">{% trans 'No order' %}</div>
            <div class="description">
                <p>{% trans 'Create one?' %}</p>
            </div>
        </div>
    </div>
    {% endfor %}
</div><!-- ./orders -->

{% if orders.has_previous or orders.has_next %}
<div class="ui vertical segment center aligned">
    <div class="ui pagination menu">
        {% if orders.has_previous %}
        <a class="item" href="?p=1">1</a>
        {% if orders.previous_page_number > 2 %}
        <div class="disabled item">...</div>
        {% endif %}
        {% if orders.previous_page_number > 1 %}
        <a class="item" href="?p={{ orders.previous_page_number }}">{{ orders.previous_page_number }}</a>
        {% endif %}
        {% endif %}<!-- ./prev -->

        <a class="active item">{{ orders.number }}</a>

        {% if orders.has_next %}
        {% if orders.next_page_number < orders.paginator.num_pages %}
        <a class="item" href="?p={{ orders.next_page_number }}">{{ orders.next_page_number }}</a>
        {% endif %}
        {% if orders.next_page_number < orders.paginator.num_pages|add:"-1" %}
        <div class="disabled item">...</div>
        {% endif %}
        <a class="item" href="?p={{ orders.paginator.num_pages }}">{{ orders.paginator.num_pages }}</a>
        {% endif %}<!-- ./next -->
    </div>
</div>
{% endif %}
{% endblock %}
